<!DOCTYPE html>
<html>

<!-- Mirrored from themazine.com/html/alquran/course-detail.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 28 Oct 2024 08:24:23 GMT -->

<head>
	<meta charset="utf-8">
	<title></title>
	<!-- Stylesheets -->
	<link href="assets/css/bootstrap.css" rel="stylesheet">
	<link href="assets/css/style.css" rel="stylesheet">
	<link href="assets/css/responsive.css" rel="stylesheet">

	<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700;800;900&amp;display=swap"
		rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&amp;display=swap"
		rel="stylesheet">

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">


	<link rel="shortcut icon" href="assets/images/logo.png" type="image/x-icon">
	<link rel="icon" href="assets/images/logo.png" type="image/x-icon">

	<!-- Responsive -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

	<!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script><![endif]-->
	<!--[if lt IE 9]><script src="js/respond.js"></script><![endif]-->
	<style>
		.container {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
			gap: 20px;
			margin: 30px;
		}

		.card {
			background: #fff;
			border-radius: 12px;
			overflow: hidden;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
			display: flex;
			flex-direction: column;
			transition: transform 0.2s ease, box-shadow 0.2s ease;
		}

		.card:hover {
			transform: translateY(-5px);
			box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
		}

		.card img {
			width: 100%;
			height: 180px;
			object-fit: cover;
		}

		.card-body {
			padding: 15px;
			flex: 1;
			display: flex;
			flex-direction: column;
			justify-content: space-between;
		}

		.card-title {
			font-size: 18px;
			font-weight: bold;
			margin-bottom: 10px;
			color: #333;
		}

		.btn {
			background: #ff6600;
			color: white;
			text-align: center;
			padding: 10px;
			border-radius: 8px;
			text-decoration: none;
			font-size: 14px;
			font-weight: bold;
			margin-bottom: 10px;
			transition: background 0.2s ease;
		}

		.btn:hover {
			background: #d65b08;
		}

		.form-check {
			display: flex;
			align-items: center;
			gap: 8px;
			margin-bottom: 8px;
		}

		.form-check input {
			width: 18px;
			height: 18px;
			cursor: pointer;
		}

		.form-check label {
			font-size: 14px;
			color: #555;
			cursor: pointer;
			line-height: 1;
		}
	</style>

</head>

<body>

	<div class="page-wrapper">

		<!-- Cursor -->
		<div class="cursor"></div>
		<div class="cursor-follower"></div>
		<!-- Cursor End -->

		<!-- Preloader -->
		<div class="preloader"></div>
		<!-- End Preloader -->

		<!-- Main Header -->
		<header class="main-header">

			<!-- Header Top -->
			<div class="header-top">
				<div class="auto-container">
					<div class="inner-container">
						<div class="d-flex justify-content-between align-items-center flex-wrap">
							<div class="left-box d-flex align-items-center flex-wrap">
								<!-- Info List -->
								<ul class="header-top_list">
									<li><span class="icon fa-solid fa-envelope fa-fw"></span>asteptowardshaq@gmail.com
									</li>
									<!-- <li><span class="icon fa-solid fa-envelope fa-fw"></span>hello123@gmail.com</li> -->
								</ul>
							</div>
							<img src="assets/images/icons/bismillah.png" class="plass">
							<ul class="header-top_list-two">
								<li><span class="icon fa-regular fa-sun fa-fw"></span>Sunrise At: 5:15 AM</li>
								<li><span class="icon fa-solid fa-moon fa-fw"></span>Sunset At: 4:50 PM</li>
								<li><span class="icon fa-solid fa-phone fa-fw"></span>Letâ€™s Talk +92 326 1420047</li>
							</ul>
						</div>
					</div>
				</div>
			</div>

			<!-- Header Upper -->
			<div class="header-upper">
				<div class="auto-container">
					<div class="inner-container">
						<div class="d-flex justify-content-between align-items-center flex-wrap">

							<div class="logo-box">
								<div class="logo"><a href="index.html"><img class="logo" src="assets/images/logo.png"
											alt="" title=""></a></div>
							</div>

							<div class="nav-outer">
								<!-- Main Menu -->
								<nav class="main-menu navbar-expand-md">
									<div class="navbar-header">
										<!-- Toggle Button -->
										<button class="navbar-toggler" type="button" data-toggle="collapse"
											data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
											aria-expanded="false" aria-label="Toggle navigation">
											<span class="icon-bar"></span>
											<span class="icon-bar"></span>
											<span class="icon-bar"></span>
										</button>
									</div>
									<div class="navbar-collapse collapse clearfix" id="navbarSupportedContent">
										<ul class="navigation clearfix">
											<li class="dropdown"><a href="index.html">Home</a></li>
											<li><a href="courses.html">Courses</a></li>
											<li><a href="certificate.html">Certificate</a></li>
											<li><a href="scholars.html">Scholars</a></li>
											<li><a href="about.html">About</a></li>
											<li><a href="contact.html">Contact</a></li>
											<li><a href="login.html">Log In</a></li>
										</ul>
									</div>
								</nav>
							</div>

							<!-- Main Menu End-->
							<div class="outer-box d-flex align-items-center flex-wrap">

								<!-- Search Btn -->
								<div class="search-box-btn search-box-outer"><span class="icon fa fa-search"></span>
								</div>

								<!-- User Box -->
								<a class="user-box theme-btn" href="login.html">
									<span class="fa-regular fa-user fa-fw"></span>
								</a>

								<!-- Button Box -->
								<div class="header_button-box">
									<a href="login.html" class="theme-btn btn-style-one">
										<span class="btn-wrap">
											<span class="text-one">Quick Join Now</span>
											<span class="text-two">Quick Join Now</span>
										</span>
									</a>
								</div>

								<!-- Mobile Navigation Toggler -->
								<div class="mobile-nav-toggler"><span class="icon flaticon-menu"></span></div>
							</div>

						</div>
					</div>
				</div>
			</div>
			<!--End Header Upper-->

			<!-- Mobile Menu  -->
			<div class="mobile-menu">
				<div class="menu-backdrop"></div>
				<div class="close-btn"><span class="icon flaticon-close-1"></span></div>

				<nav class="menu-box">
					<div class="nav-logo"><a href="index.html"><img src="assets/images/logo.png" alt="" title=""></a>
					</div>
					<div class="menu-outer">
						<!--Here Menu Will Come Automatically Via Javascript / Same Menu as in Header-->
					</div>
				</nav>
			</div>
			<!-- End Mobile Menu -->

		</header>
		<!-- End Main Header -->

		<!-- Page Title -->
		<section class="page-title" style="background-image:url(assets/images/background/page-title.jpg)">
			<div class="auto-container">
				<h2>Courses Details</h2>
				<ul class="bread-crumb clearfix">
					<li><a href="index.html">Home</a></li>
					<li>Courses Details</li>
				</ul>
			</div>
		</section>
		<!-- End Page Title -->

		<!-- Sidebar Page Container -->
		<div class="sidebar-page-container style-two">
			<div class="auto-container">
				<div class="row clearfix">

					<!-- Content Side -->
					<div class="content-side col-lg-8 col-md-12 col-sm-12">
						<div class="course-detail">
							<div class="course-detail_inner">
								<div class="course-detail_image">
									<img src="https://img.youtube.com/vi/So5Zq8HU-7E/0.jpg" alt="" />
								</div>
								<div class="course-detail_content">
									<h3 class="course-detail_heading"></h3>
									<h4 class="course-detail_subtitle">Overview</h4>
									<p id="course-description"></p>

									<!-- Product Info Tabs -->
									<div class="course-detail-info-tabs">
										<!-- Product Tabs -->
										<div class="course-detail-tabs tabs-box">


											<!-- Tabs Container -->
											<!-- Tab -->

											<h4>Course Videos</h4>
											<div data-course-id="1">
												<div id="course-videos-section"></div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<!-- Sidebar Side -->
					<div class="sidebar-side col-lg-4 col-md-12 col-sm-12">
						<aside class="sidebar">

							<!-- Course Widget -->
							<div class="sidebar-widget course-widget">
								<div class="widget-content">
									<!-- Sidebar Title -->
									<div class="sidebar-title">
										<h4>Course Features</h4>
									</div>
									<ul class="course-list">
										<li>Course Fee <span>Free</span></li>
										<li>Lessons <span>7</span></li>
										<li>Category<span>Salaat</span></li>
										<li>Level<span>Advanced</span></li>
									</ul>
									<a class="theme-btn course-appy_btn" href="#" id="startNowBtn">Start Now</a>
								</div>
							</div>

							<!-- Helpline Widget -->
							<div class="sidebar-widget helpline-widget">
								<div class="widget-content">
									<div class="image">
										<img src="assets/images/icons/helpline-widget.png" alt="" />
									</div>
									<h4 class="helpline-title">If you have any further query then you can contact our
										helpline</h4>
									<div class="helpline-widget_phone flaticon-phone-call"></div>
									<div class="helpline-widget_number">Helpline: 0241-21131 <span>(10AM-5PM)</span>
									</div>
								</div>
							</div>

						</aside>
					</div>

				</div>
			</div>
		</div>

		<!-- Footer Style -->
		<footer class="main-footer">
			<div class="footer_bg-image" style="background-image: url(assets/images/background/footer-bg.jpg)"></div>
			<div class="auto-container">
				<div class="inner-container">
					<!-- Widgets Section -->
					<div class="widgets-section">
						<div class="row clearfix">

							<!-- Big Column -->
							<div class="big-column col-lg-6 col-md-12 col-sm-12">
								<div class="row clearfix">

									<!-- Footer Column -->
									<div class="footer-column col-lg-6 col-md-6 col-sm-12">
										<div class="footer-widget logo-widget">
											<div class="footer-logo"><a href="index.html"><img
														src="assets/images/footer-logo.png" style="width: 60%;"></a>
											</div>
											<!-- Footer List -->
											<div class="footer_list">
												<li>+92 326 1420047</li>
											</div>
											<!-- Social Box -->
											<div class="footer_socials">
												<div>
													<a href="https://facebook.com/"><i
															class="fa-brands fa-facebook-f"></i></a>
													<a href="https://wa.me/+923261420047"><i
															class="fa-brands fa-whatsapp"></i></a>
													<a
														href="https://youtube.com/@a_step_towards_haq?si=iiLH6sLAEjM-aUw0"><i
															class="fa-brands fa-youtube"></i></a>
												</div>
												<div class=".he" style="margin-top: 4px;">
													<a
														href="https://www.snapchat.com/add/asteptowardshaq?share_id=QT5D7OeFhWg&locale=en-GB"><i
															class="fa-brands fa-snapchat"></i></a>
													<a
														href="https://www.tiktok.com/@a_step_towards_haq?_t=ZS-8sqeo7VFicC&_r=1"><i
															class="fa-brands fa-tiktok"></i></a>
													<a href="https://instagram.com/"><i
															class="fa-brands fa-instagram"></i></a>
												</div>
											</div>
										</div>
									</div>

									<!-- Footer Column -->
									<div class="footer-column col-lg-6 col-md-6 col-sm-12">
										<div class="footer-widget links-widget">
											<h4 class="footer-title">Links</h4>
											<ul class="footer-list">
												<li><a href="about.html">About us</a></li>
												<li><a href="scholars.html">Scholars</a></li>
												<li><a href="courses.html">Courses</a></li>
												<li><a href="contact.html">Contact</a></li>
											</ul>
										</div>
									</div>

								</div>
							</div>

							<!-- Big Column -->
							<div class="big-column col-lg-6 col-md-12 col-sm-12">
								<div class="row clearfix">

									<!-- Footer Column -->
									<div class="footer-column col-lg-6 col-md-6 col-sm-12">
										<div class="footer-widget links-widget">
											<h4 class="footer-title">Other Link</h4>
											<ul class="footer-list">
												<li><a href="#">Online Courses</a></li>
												<li><a href="#">Audio Listening</a></li>
												<li><a href="login.html">Certificate</a></li>
											</ul>
										</div>
									</div>

									<!-- Footer Column -->
									<div class="footer-column col-lg-6 col-md-6 col-sm-12">
										<div class="footer-widget newsletter-widget">
											<h4 class="footer-title">newsletter</h4>
											<div class="footer-text">Waiting for your message!</div>
											<div class="newsletter-box">
												<form method="post"
													action="https://themazine.com/html/alquran/contact.html">
													<div class="form-group">
														<input type="email" name="search-field" value=""
															placeholder="email address" required>
														<button type="submit"
															class="theme-btn fa-regular fa-paper-plane fa-fw"></button>
													</div>
												</form>
											</div>
										</div>
									</div>

								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</footer>
		<!-- End Footer Style -->

		<!-- Search Popup -->
		<div class="search-popup">
			<div class="color-layer"></div>
			<button class="close-search"><span class="flaticon-close-1"></span></button>
			<form method="post" action="https://themazine.com/html/alquran/blog.html">
				<div class="form-group">
					<input type="search" name="search-field" value="" placeholder="Search Here" required="">
					<button class="fa fa-solid fa-magnifying-glass fa-fw" type="submit"></button>
				</div>
			</form>
		</div>
		<!-- End Search Popup -->

	</div>
	<!-- End PageWrapper -->

	<div class="progress-wrap">
		<svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
			<path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98" />
		</svg>
	</div>

	<script src="assets/js/jquery.js"></script>
	<script src="assets/js/popper.min.js"></script>
	<script src="assets/js/bootstrap.min.js"></script>
	<script src="assets/js/appear.js"></script>
	<script src="assets/js/parallax.min.js"></script>
	<script src="assets/js/tilt.jquery.min.js"></script>
	<script src="assets/js/jquery.paroller.min.js"></script>
	<script src="assets/js/wow.js"></script>
	<script src="assets/js/jarallax.js"></script>
	<script src="assets/js/swiper.min.js"></script>
	<script src="assets/js/backtotop.js"></script>
	<script src="assets/js/odometer.js"></script>
	<script src="assets/js/parallax-scroll.js"></script>

	<script src="assets/js/gsap.min.js"></script>
	<script src="assets/js/SplitText.min.js"></script>
	<script src="assets/js/ScrollTrigger.min.js"></script>
	<script src="assets/js/ScrollToPlugin.min.js"></script>
	<script src="assets/js/ScrollSmoother.min.js"></script>

	<script src="assets/js/magnific-popup.min.js"></script>
	<script src="assets/js/nav-tool.js"></script>
	<script src="assets/js/jquery-ui.js"></script>
	<script src="assets/js/element-in-view.js"></script>
	<script src="assets/js/script.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
	<script src="config.js"></script>
	<script>
		const token = localStorage.getItem('token');

		// Get course_id from URL
		function getCourseIdFromUrl() {
			const params = new URLSearchParams(window.location.search);
			return params.get('course_id');
		}
		function renderCourseDetails(course) {
			document.querySelector('.course-detail_image img').src = course.image_url || `https://img.youtube.com/vi/${course.videos[0]?.youtube_url.split('v=')[1] || ''}/0.jpg`;
			document.querySelector('.course-detail_heading').textContent = course.name;
			document.getElementById('course-description').textContent = course.description || '';
		}

		// to handle the youtube url and extract id
		function extractYouTubeId(url) {
			// Handles both youtu.be and youtube.com URLs, strips query params
			let id = '';
			if (url.includes('youtu.be/')) {
				id = url.split('youtu.be/')[1].split('?')[0];
			} else if (url.includes('youtube.com')) {
				const v = url.split('v=')[1];
				id = v ? v.split('&')[0] : '';
			}
			return id;
		}
		async function renderCourseVideos(videos, courseId) {
			const section = document.getElementById('course-videos-section');
			section.innerHTML = '<div class="container"></div>';
			const container = section.querySelector('.container');

			// Fetch saved progress for this user/course using GET
			let completedVideosCount = 0;
			if (token) {
				try {
					const res = await fetch(window.API_BASE_URL + `/api/courses/progress/${courseId}`, {
						method: 'GET',
						headers: {
							'Authorization': 'Bearer ' + token
						}
					});
					if (res.ok) {
						const data = await res.json();
						if (data.completed_videos !== undefined) {
							completedVideosCount = data.completed_videos;
						}
					}
				} catch (e) { }
			}

			videos.forEach((video, idx) => {
				const videoId = extractYouTubeId(video.youtube_url);
				const card = document.createElement('div');
				card.className = 'card';
				card.innerHTML = `
			<img src="https://img.youtube.com/vi/${videoId}/0.jpg" alt="Video Thumbnail">
			<div class="card-body">
				<h3 class="card-title">${video.title}</h3>
				<a href="${video.youtube_url}" target="_blank" class="btn">Watch Video</a>
				<div class="form-check">
					<input type="checkbox" id="video${idx}">
					<label for="video${idx}">Mark as Completed</label>
				</div>
			</div>
		`;
				container.appendChild(card);
			});
			// Check if MCQs exist for this course before showing test button
			fetch(window.API_BASE_URL + `/api/test/mcqs/${courseId}`)
				.then(res => res.json())
				.then(data => {
					if (data.questions && data.questions.length > 0) {
						// Add test button
						const testDiv = document.createElement('div');
						testDiv.style.marginTop = '40px';
						testDiv.style.textAlign = 'center';
						testDiv.style.gridColumn = '1 / -1';
						testDiv.innerHTML = `<a href="#" class="btn" id="testBtn">Watch All Videos for test</a>`;
						container.appendChild(testDiv);
						// Progress logic
						const videoCheckboxes = container.querySelectorAll('.form-check input[type="checkbox"]');
						const totalVideos = videoCheckboxes.length;
						const testBtn = container.querySelector('#testBtn');
						// Set saved progress (check completed checkboxes)
						for (let i = 0; i < completedVideosCount && i < videoCheckboxes.length; i++) {
							videoCheckboxes[i].checked = true;
						}
						function getCompletedVideos() {
							return Array.from(videoCheckboxes).filter(cb => cb.checked).length;
						}
						function updateProgress() {
							const completed = getCompletedVideos();
							if (testBtn) {
								if (completed === totalVideos) {
									testBtn.textContent = "Start Test";
									testBtn.onclick = function (e) {
										e.preventDefault();
										window.location.href = `test.html?course_id=${courseId}`;
									};
									testBtn.classList.add("btn-success");
								} else {
									testBtn.textContent = "Watch All Videos for test";
									testBtn.onclick = function (e) { e.preventDefault(); };
									testBtn.classList.remove("btn-success");
								}
							}
							saveProgress(courseId, completed);
						}
						function saveProgress(courseId, completedVideos) {
							if (!token) return;
							fetch(window.API_BASE_URL + "/api/courses/progress", {
								method: 'POST',
								headers: {
									'Content-Type': 'application/json',
									'Authorization': 'Bearer ' + token
								},
								body: JSON.stringify({
									course_id: courseId,
									completed_videos: completedVideos
								})
							});
						}
						videoCheckboxes.forEach(input => {
							input.addEventListener('change', updateProgress);
						});
						updateProgress();
					} else {
						// Show message if no test is available
						const msgDiv = document.createElement('div');
						msgDiv.style.marginTop = '40px';
						msgDiv.style.textAlign = 'center';
						msgDiv.style.gridColumn = '1 / -1';
						msgDiv.innerHTML = `<span class="text-warning">Test for this course will be available soon.</span>`;
						container.appendChild(msgDiv);
					}
				});
		}

		document.getElementById('startNowBtn').addEventListener('click', function (e) {
			e.preventDefault();
			const courseId = getCourseIdFromUrl();
			if (!courseId) return;
			if (!token) {
				// Not logged in, redirect to login
				window.location.href = 'login.html?redirect=' + encodeURIComponent(window.location.href);
				return;
			}
			// Enroll user in course (assign course to user in DB)
			fetch(window.API_BASE_URL + "/api/courses/enroll", {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
					'Authorization': 'Bearer ' + token
				},
				body: JSON.stringify({ course_id: courseId })
			})
				.then(() => {
					// After enrolling, fetch course details and videos
					return fetch(window.API_BASE_URL + "/api/courses/" + courseId);
				})
				.then(res => res.json())
				.then(course => {
					renderCourseDetails(course);
					renderCourseVideos(course.videos, courseId);
					// Remove Start Now button after showing videos
					document.getElementById('startNowBtn').remove();
				})
				.catch(() => {
					document.getElementById('course-videos-section').innerHTML = '<p>Error loading course videos.</p>';
				});
		});

		// Always show course name/description, only show videos if logged in/enrolled
		window.addEventListener('DOMContentLoaded', () => {
			const btn = document.getElementById('startNowBtn');
			const courseId = getCourseIdFromUrl();
			if (!courseId) return;
			// Always fetch course details
			fetch(window.API_BASE_URL + `/api/courses/${courseId}`)
				.then(res => res.json())
				.then(course => {
					renderCourseDetails(course);
					// Only show videos if logged in
					if (token) {
						// Optionally auto-enroll if not already enrolled (backend handles idempotency)
						fetch(window.API_BASE_URL + "/api/courses/enroll", {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json',
								'Authorization': 'Bearer ' + token
							},
							body: JSON.stringify({ course_id: courseId })
						})
							.then(() => {
								renderCourseVideos(course.videos, courseId);
								if (btn) btn.remove();
							})
							.catch(() => {
								document.getElementById('course-videos-section').innerHTML = '<p>Error loading course videos.</p>';
							});
					}
				})
				.catch(() => {
					document.getElementById('course-videos-section').innerHTML = '<p>Error loading course details.</p>';
				});
		});
	</script>

</body>

<!-- Mirrored from themazine.com/html/alquran/course-detail.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 28 Oct 2024 08:24:30 GMT -->

</html>